<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Catalog</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: url("https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExemg2dGkxM3o5aGxucXNncTI3eW44OW1ma2JhemRjZGo5YThsZmI1ZCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/Kann6y6Z5CeZCOyWr5/giphy.webp") no-repeat center center fixed;
            background-size: cover;
        }

        .form-container {
            /* background-color: rgba(211, 210, 233, 0.688); */
            
            background-color: rgba(221, 212, 212, 0.321);
            /* background: url("data:image/jpeg;base64,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"); */
            /* background-repeat: no-repeat;
            background-size: cover; */
            border-radius: 10px;
            box-shadow: 2 0 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
            max-width: 1200px;
            width: 100%;
            margin: 20px;
        }

        .tab {
            display: inline-block;
            padding: 12px 20px;
            cursor: pointer;
            background: #6c63ff;
            color: #fff;
            border: none;
            border-radius: 8px;
            margin: 5px;
            text-shadow: 4px 4px 4px rgba(0, 0, 0, 0.636);
            font-size: 25px;
            transition: background 0.3s ease;
        }

        .tab:hover {
            background: #534f9d;
        }

        .active {
            background: #4a42cf;
        }

        .message {
            margin: 15px 0;
            padding: 10px;
            border-radius: 8px;
            font-size: 20px;
        }

        .message.success {
            background: #d4edda;
            color: #155724;
        }

        .message.error {
            background: #f8d7da;
            color: #721c24;
        }

        #product-page {
            display: none;
        }

        table {
            width: 100%;
            font-size: medium;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th,
        td {
            padding: 14px;
            font-size: x-large;
            color: white;
            font-weight: 600;
            text-align: left;
            border-bottom: 1px solid #131313;
        }

        th {
            background-color: #6c63ff;
            color: white;
        }

        #back-button {
            background: #6c63ff;
            color: #fff;
            border: none;
            padding: 12px;
            text-shadow: 4px 4px 4px rgba(0, 0, 0, 0.636);
            border-radius: 10px;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.2s ease;
            /* Smooth transition for press effect */
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
            /* 3D effect with shadow */
        }

        /* Add a pressed state */
        #back-button:active {
            background: #5a54e0;
            /* Slightly darker shade on press */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            /* Reduce shadow size */
            transform: translateY(4px);
            /* Move the button down slightly */
        }

        #back-button:hover {
            background: #4e4e8e;
        }

        input[type="text"],
        input[type="password"] {
            width: calc(100% - 24px);
            padding: 12px;
            background-color: #fcfcfc6e;
            margin: 10px 0;
            border: 0px solid #0d0d0d;
            border-radius: 6px;
            text-shadow: 4px 4px 4px rgba(100, 82, 130, 0.636);
            font-size: 25px;
        }

        button[type="submit"],
        .action-button {
            background: #6c63ff;
            color: #fff;
            border: 2px 2px #000000;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 20px;
            transition: background 0.3s ease;
        }

        button[type="submit"]:hover,
        .action-button:hover {
            background: #4a42cf;
        }

        h2 {
            color: #6c63ff;
            font-size: xxx-large;
            text-shadow: 4px 4px 4px rgba(0, 0, 0, 0.636);
            font-weight: bold;
            margin-bottom: 10px;
        }

        .action-button {
            margin: 5px;
            text-shadow: 4px 4px 4px rgba(0, 0, 0, 0.636);
            border-radius: 8px;
            padding: 8px 16px;
            font-size: 20px;
            min-width: 100px;
        }
    </style>
</head>

<body>
    <div id="form-container" class="form-container">
        <button id="login-tab" class="tab active">Login</button>
        <button id="signup-tab" class="tab">Signup</button>

        <div id="login-form">
            <h2>Login</h2>
            <div id="login-message" class="message"></div>
            <form id="login-form-element">
                <input type="text" id="login-username" value="kaja" placeholder="Username" required>
                <input type="password" id="login-password" value="kaja" placeholder="Password" required>
                <button type="submit">Login</button>
            </form>
        </div>

        <div id="signup-form" style="display: none;">
            <h2>Signup</h2>
            <div id="signup-message" class="message"></div>
            <form id="signup-form-container">
                <input type="text" id="signup-username" value="kaja" placeholder="Username" required>
                <input type="password" id="signup-password" value="kaja" placeholder="Password" required>
                <button type="submit">Signup</button>
            </form>
        </div>
    </div>

    <div id="product-page" class="form-container">
        <button id="back-button">Back</button>
        <h2>Products</h2>
        <div id="product-message" class="message"></div>
        <form id="product-form">
            <input type="text" id="product-name" placeholder="Product Name" required>
            <input type="text" id="product-description" placeholder="Product Description" required>
            <button type="submit">Add Product</button>
        </form>
        <table id="product-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Description</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <script>
        const apiUrl = 'https://products-backend-o7su.onrender.com';
        let currentProductId = null; // Initialize current product ID

        document.getElementById('login-tab').addEventListener('click', () => {
            document.getElementById('login-form').style.display = 'block';
            document.getElementById('signup-form').style.display = 'none';
            document.getElementById('login-tab').classList.add('active');
            document.getElementById('signup-tab').classList.remove('active');
        });

        document.getElementById('signup-tab').addEventListener('click', () => {
            document.getElementById('login-form').style.display = 'none';
            document.getElementById('signup-form').style.display = 'block';
            document.getElementById('login-tab').classList.remove('active');
            document.getElementById('signup-tab').classList.add('active');
        });

        document.getElementById('login-form-element').addEventListener('submit', async (e) => {
            e.preventDefault();
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;
            const messageElement = document.getElementById('login-message');

            try {
                const response = await fetch(`${apiUrl}/api/sellers/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ username, password })
                });

                if (response.ok) {
                    const data = await response.json();
                    localStorage.setItem('token', data.token);
                    document.getElementById('form-container').style.display = 'none';
                    document.getElementById('product-page').style.display = 'block';
                    loadProducts();
                } else {
                    const error = await response.json();
                    messageElement.textContent = `Error: ${error.error}`;
                    messageElement.className = 'message error';
                }
            } catch (error) {
                console.error('Login error:', error);
                messageElement.textContent = 'An unexpected error occurred.';
                messageElement.className = 'message error';
            }
        });

        document.getElementById('signup-form-container').addEventListener('submit', async (e) => {
            e.preventDefault();
            const username = document.getElementById('signup-username').value;
            const password = document.getElementById('signup-password').value;
            const messageElement = document.getElementById('signup-message');

            try {
                const response = await fetch(`${apiUrl}/api/sellers/signup`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ username, password })
                });
                console.log(response.status);
                if (response.ok) {
                    messageElement.textContent = 'Signup successful! Please log in.';
                    messageElement.className = 'message success';
                    document.getElementById('signup-form').reset();
                } else {
                    const error = await response.json();
                    messageElement.textContent = `Error: ${error.error}`;
                    // messageElement.className = 'message error';
                }
            } catch (error) {
                console.error('Signup error:', error);
                messageElement.textContent = 'An unexpected error occurred.';
                messageElement.className = 'message error';
            }
        });

        function loadProducts() {
            fetch(`${apiUrl}/api/products`, {
                headers: {
                    'Authorization': `Bearer ${localStorage.getItem('token')}`
                }
            })
                .then(response => response.json())
                .then(products => {
                    const productTableBody = document.querySelector('#product-table tbody');
                    productTableBody.innerHTML = '';

                    products.forEach(product => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${product._id}</td>
                            <td>${product.name}</td>
                            <td>${product.description}</td>
                            <td>
                                <button class="action-button edit-button" data-id="${product._id}">Edit</button>
                                <button class="action-button delete-button" data-id="${product._id}">Delete</button>
                            </td>
                        `;
                        productTableBody.appendChild(row);
                    });

                    document.querySelectorAll('.edit-button').forEach(button => {
                        button.addEventListener('click', () => {
                            currentProductId = button.getAttribute('data-id');
                            const product = products.find(p => p._id === currentProductId);
                            document.getElementById('product-name').value = product.name;
                            document.getElementById('product-description').value = product.description;
                        });
                    });

                    document.querySelectorAll('.delete-button').forEach(button => {
                        button.addEventListener('click', () => {
                            const productId = button.getAttribute('data-id');
                            deleteProduct(productId);
                        });
                    });
                })
                .catch(error => {
                    console.error('Error loading products:', error);
                });
        }

        document.getElementById('product-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('product-name').value;
            const description = document.getElementById('product-description').value;

            if (currentProductId) {
                updateProduct(currentProductId, { name, description });
            } else {
                addProduct({ name, description });
            }
        });

        function addProduct(product) {
            fetch(`${apiUrl}/api/products`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${localStorage.getItem('token')}`
                },
                body: JSON.stringify(product)
            })
                .then(response => response.json())
                .then(() => {
                    document.getElementById('product-form').reset();
                    currentProductId = null;
                    loadProducts();
                })
                .catch(error => {
                    console.error('Error adding product:', error);
                });
        }

        function updateProduct(productId, product) {
            fetch(`${apiUrl}/api/products/${productId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${localStorage.getItem('token')}`
                },
                body: JSON.stringify(product)
            })
                .then(response => response.json())
                .then(() => {
                    document.getElementById('product-form').reset();
                    currentProductId = null;
                    loadProducts();
                })
                .catch(error => {
                    console.error('Error updating product:', error);
                });
        }

        function deleteProduct(productId) {
            fetch(`${apiUrl}/api/products/${productId}`, {
                method: 'DELETE',
                headers: {
                    'Authorization': `Bearer ${localStorage.getItem('token')}`
                }
            })
                .then(() => {
                    loadProducts();
                })
                .catch(error => {
                    console.error('Error deleting product:', error);
                });
        }

        document.getElementById('back-button').addEventListener('click', () => {
            document.getElementById('form-container').style.display = 'block';
            document.getElementById('product-page').style.display = 'none';
        });
    </script>
</body>

</html>